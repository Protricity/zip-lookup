/*
 * $.zipLookup v0.1
 *   - by Ari Asulin (ari.asulin at gmail.com)
 *   - jQuery plugin to dynamically fill in City/State Form Fields using an ajax Zipcode lookup
 *   - Apache License, Version 2.0
 *
 */
(function(e){e.extend({zipLookupSettings:{libDirPath:null,dbPath:"db/",country:"us",onFound:function(){},onNotFound:function(){},onError:function(){}},zipLookup:function(t,n,r){if(n instanceof Function)n={onFound:n};n=jQuery.extend(true,{},jQuery.zipLookupSettings,n);if(r instanceof Function)n.onNotFound=r;if(n.libDirPath==null){var i=e("script[src*='zipLookup.js'],script[src*='zipLookup.min.js']").attr("src");if(i)n.libDirPath=i.replace("zipLookup.js","").replace("zipLookup.min.js","");else n.libDirPath="ziplookup/"}if(!parseInt(t,10))return n.onNotFound("Invalid zip code: "+t);t=parseInt(t,10);var s=parseInt(t/100);var o=parseInt(t%100);var u=n.libDirPath+n.dbPath+n.country+"/"+s+".js";e.ajax({url:u,dataType:"jsonp",jsonpCallback:"__zl",cache:true,success:function(e){if(e===undefined||e[0]===undefined)return n.onNotFound("Zipcode Not Found in DB");var t=e[0][o];if(e[1][t]===undefined)return n.onNotFound("Zipcode Not Found in DB");var r=e[1][t].split("|");var i=r[0];if(!r[1])r[1]=0;var s=r[1];var u=e[2][s].split("|");var a=u[1];var f=u[0];n.onFound(i,a,f)},fail:function(e,t){n.onError(e,t);n.onNotFound("Error: "+t)}})}})})(jQuery)